<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CometFlow - Browser Automation Suite</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui; background: #050914; color: #e5e7eb; }
    header { padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
    h1 { margin: 0; font-size: 1.5rem; }
    button { padding: 10px 20px; border-radius: 8px; border: none; background: #22d3ee; color: #000; cursor: pointer; font-weight: 600; }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    .hidden { display: none; }
    .landing { text-align: center; padding: 60px 20px; }
    .landing h2 { font-size: 2.5rem; margin: 20px 0; }
    .landing p { font-size: 1.1rem; color: #9ca3af; margin: 20px 0; }
    .landing button { padding: 15px 40px; font-size: 1rem; margin-top: 20px; }
  </style>
</head>
<body>
  <header>
    <h1>ðŸŒŸ CometFlow</h1>
    <div id="userBox">
      <button onclick="showLogin()">Sign In</button>
    </div>
  </header>

  <!-- Landing Page (Initial) -->
  <div id="landing" class="container landing">
    <h2>Browser Automation. Simplified.</h2>
    <p>Automate web monitoring, social media posting, and task execution across all platforms.</p>
    <button onclick="showLogin()">Get Started</button>
  </div>

  <!-- Login (Hidden Initially) -->
  <div id="authPage" class="container hidden">
    <div style="max-width: 400px; margin: 60px auto; border: 1px solid #333; padding: 30px; border-radius: 10px;">
      <h2>Sign In to CometFlow</h2>
      <input id="email" type="email" placeholder="Email" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #333; border-radius: 5px; background: #0f172a; color: #e5e7eb;">
      <input id="password" type="password" placeholder="Password" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #333; border-radius: 5px; background: #0f172a; color: #e5e7eb;">
      <button onclick="emailSignUp()" style="width: 100%; margin-top: 15px;">Sign Up</button>
      <button onclick="emailLogin()" style="width: 100%; margin-top: 10px; background: #6b7280;">Login</button>
      <button onclick="googleLogin()" style="width: 100%; margin-top: 10px; background: #4285f4;">Sign in with Google</button>
      <button onclick="showLanding()" style="width: 100%; margin-top: 10px; background: #666;">Back</button>
    </div>
  </div>

  <!-- App Dashboard (Hidden Initially) -->
  <div id="appDashboard" class="container hidden">
    <h2>Welcome to CometFlow</h2>
    <p>User: <span id="userEmail"></span></p>
    <button onclick="logout()">Logout</button>
  </div>

  <!-- Firebase Scripts - FIRST -->
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-firestore.js"></script>

  <!-- Firebase Initialization - MUST BE BEFORE FUNCTIONS -->
  <script>
    // Initialize Firebase FIRST
    const firebaseConfig = {
      apiKey: "AIzaSyAYDhqY88uclZN2UMleOY0Dbg6-07e2Q2Y",
      authDomain: "cometflow-app.firebaseapp.com",
      projectId: "cometflow-app",
      storageBucket: "cometflow-app.firebasestorage.app",
      messagingSenderId: "693582343294",
      appId: "1:693582343294:web:92850989124e30fda1bc2f"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Navigation Functions
    function showLanding() { document.getElementById('landing').classList.remove('hidden'); document.getElementById('authPage').classList.add('hidden'); document.getElementById('appDashboard').classList.add('hidden'); }
    function showLogin() { document.getElementById('landing').classList.add('hidden'); document.getElementById('authPage').classList.remove('hidden'); document.getElementById('appDashboard').classList.add('hidden'); }
    function showApp() { document.getElementById('landing').classList.add('hidden'); document.getElementById('authPage').classList.add('hidden'); document.getElementById('appDashboard').classList.remove('hidden'); }

    // Auth Functions
    async function emailSignUp() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await auth.createUserWithEmailAndPassword(email, password);
        alert('Sign up successful!');
        showApp();
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }

    async function emailLogin() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        await auth.signInWithEmailAndPassword(email, password);
        showApp();
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }

    function googleLogin() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).then(result => {
        showApp();
      }).catch(error => {
        alert('Error: ' + error.message);
      });
    }

    function logout() {
      auth.signOut().then(() => {
        showLanding();
      });
    }

    // Auth State Listener
    auth.onAuthStateChanged(user => {
      if (user) {
        document.getElementById('userEmail').textContent = user.email;
        showApp();
      } else {
        showLanding();
      }
    });
  </script>
</body>
</html>
